#!/bin/bash

# This shell script combines the source files into the archive.

echo "Compile archive..."

# pre build cleanup
rm -rf var

# fill archive
mkdir -p var/stronghold_s5mp/archive.bba.unpacked
cp -r modfiles/config var/stronghold_s5mp/archive.bba.unpacked
cp -r modfiles/graphics var/stronghold_s5mp/archive.bba.unpacked
cp -r modfiles/script var/stronghold_s5mp/archive.bba.unpacked
cp -r modfiles/text var/stronghold_s5mp/archive.bba.unpacked
# loaded externaly and is currently not needed in the archive
#cp -r modfiles/menu var/stronghold_s5mp/archive.bba.unpacked

# fill mod folder
#cp modfiles/loader.lua var/stronghold_s5mp

# copy cerberus folder
mkdir -p var/stronghold_s5mp/archive.bba.unpacked/script
cp -r "E:/Repositories/cerberus" var/stronghold_s5mp/archive.bba.unpacked/script
rm -rf var/stronghold_s5mp/archive.bba.unpacked/script/cerberus/.git
rm -rf var/stronghold_s5mp/archive.bba.unpacked/script/cerberus/.vscode
rm -rf var/stronghold_s5mp/archive.bba.unpacked/script/cerberus/test
rm var/stronghold_s5mp/archive.bba.unpacked/script/cerberus/.gitignore
rm var/stronghold_s5mp/archive.bba.unpacked/script/cerberus/changelog.md
rm var/stronghold_s5mp/archive.bba.unpacked/script/cerberus/readme.md

# copy additional files
cp modfiles/sh.loader.lua var/stronghold_s5mp/sh.loader.lua
cp modfiles/menu/projects/ingame.xml var/stronghold_s5mp/SH_GUI.xml

# pack archive
bin/bba5.exe var/stronghold_s5mp/archive.bba.unpacked

# post build cleanup
rm -rf var/stronghold_s5mp/archive.bba.unpacked

echo "Stronghold compiled!"